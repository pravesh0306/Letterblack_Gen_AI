<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gen_AI_Assist - VS Code Style</title>
    <link rel="stylesheet" href="css/vscode-theme.css">
    <link rel="stylesheet" href="css/core.css">
    <link rel="stylesheet" href="css/header.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/chat.css">
    <link rel="stylesheet" href="css/code-display.css">
    <link rel="stylesheet" href="css/script.css">
    <link rel="stylesheet" href="css/settings.css">
    <link rel="stylesheet" href="css/tabs.css">
    <link rel="stylesheet" href="css/api-feedback.css">
    <link rel="stylesheet" href="css/image-upload.css">
    <!-- Mascot Animator (reusable system) -->
    <link rel="stylesheet" href="Reusable_Mascot_System/css/mascot-animator.css">
    <!-- Inline a11y utility -->
    <style>
        .sr-only{position:absolute!important;width:1px!important;height:1px!important;padding:0!important;margin:-1px!important;overflow:hidden!important;clip:rect(0 0 0 0)!important;white-space:nowrap!important;border:0!important;}
    </style>
</head>
<body class="vscode-dark">
    <div id="app" class="vscode-app">
        <!-- Header Bar (48px) -->
        <header class="vscode-header">
            <div class="header-left">
                <img src="assets/ae-mascot.png" alt="Gen_AI_Assist" width="20" height="20" class="app-mascot">
                <div class="app-identity">
                    <span class="app-title">Gen_AI_Assist</span>
                    <span class="app-subtitle">LetterBlack_Gen_Ai Creative Suite Assistant</span>
                </div>
            </div>
            <div class="header-right">
                <button id="command-menu-trigger" class="header-btn" title="Command Palette (Ctrl+K)" aria-expanded="false" aria-controls="command-menu-panel">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"/>
                    </svg>
                </button>
                <button id="main-tabs-toggle" class="header-btn" title="Toggle Tools Panel" aria-expanded="false" aria-controls="settings-panel">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M3,3H21V7H3V3M3,9H21V13H3V9M3,15H21V19H3V15Z"/>
                    </svg>
                </button>
            </div>
        </header>

        <!-- Command Palette -->
    <div id="command-menu-panel" class="command-palette hidden">
            <div class="command-palette-content">
                <div class="palette-section">
                    <h4>Recent Commands</h4>
                    <div id="command-history-list" class="command-list">
                        <!-- Dynamic content -->
                    </div>
                </div>
                <div class="palette-section">
                    <h4>Quick Actions</h4>
                    <div class="quick-actions">
                        <button class="command-item" data-template="text">Text Animation</button>
                        <button class="command-item" data-template="particles">Particle System</button>
                        <button class="command-item" data-template="transitions">Scene Transitions</button>
                        <button class="command-item" data-template="effects">Visual Effects</button>
                    </div>
                </div>
                <div class="palette-section">
                    <h4>Context Actions</h4>
                    <button id="read-expression-btn" class="command-item">Read Expression</button>
                    <button id="analyze-selection-btn" class="command-item">Analyze Selection</button>
                    <button id="show-context-btn" class="command-item">Show Context</button>
                </div>
                <div class="palette-section">
                    <h4>Expression Helper</h4>
                    <button id="read-expression-helper-btn" class="command-item">Read Expression</button>
                    <button id="explain-expression-btn" class="command-item">Explain Expression</button>
                    <button id="debug-expression-btn" class="command-item">Debug Expression</button>
                </div>
            </div>
        </div>

        <!-- Main Working Area -->
        <main class="main-content">
            <!-- Chat Area (Top) -->
            <section class="chat-area">
                <!-- Context Bar (32-36px) -->
                <div class="context-bar">
                    <div class="context-left">
                        <button id="eye-toggle" class="context-btn" title="Toggle Visibility" aria-pressed="true">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"/>
                            </svg>
                        </button>
                        <nav class="breadcrumb" id="selection-breadcrumb">
                            <span class="breadcrumb-item">Comp</span>
                            <span class="breadcrumb-chevron">›</span>
                            <span class="breadcrumb-item">Layer</span>
                            <span id="property-separator" class="breadcrumb-chevron hidden">›</span>
                            <span id="property-name" class="breadcrumb-item hidden">Property</span>
                        </nav>
                    </div>
                    <div class="context-right">
                        <span id="context-indicator" class="context-chip">Context Shared</span>
                    </div>
                </div>

                <!-- Messages Container -->
                <div class="messages-container">
                    <div id="chat-messages" class="chat-messages">
                        <!-- Welcome message -->
                        <div class="message system">
                            <div class="message-content">
                                <h3>Welcome</h3>
                                <p>Your VS Code-style AI assistant for After Effects. Ask questions, request scripts, or get help with your projects.</p>
                            </div>
                            <div class="message-timestamp">6:14 PM</div>
                        </div>
                    </div>
                </div>

                <!-- Composer -->
                <div class="composer">
                    <!-- Image Preview Area -->
                    <div id="image-preview-area" class="image-preview-container hidden">
                        <div class="image-preview-content">
                            <img id="image-preview" class="image-preview-img" alt="Image preview">
                            <div class="image-preview-info">
                                <span id="image-preview-name"></span>
                                <button id="remove-image-btn" class="remove-image-btn" title="Remove image">×</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="composer-main">
                        <textarea 
                            id="chat-input" 
                            class="composer-input" 
                            placeholder="Send a message..." 
                            rows="1" 
                            maxlength="1000"></textarea>
                        <div class="composer-actions">
                            <button id="image-upload-btn" class="composer-btn" title="Upload Image Reference">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M9,12L11,14L15,9L21,16H3L9,12M5,3H19A2,2 0 0,1 21,5V19A2,2 0 0,1 19,21H5A2,2 0 0,1 3,19V5A2,2 0 0,1 5,3Z"/>
                                </svg>
                            </button>
                            <input type="file" id="image-upload-input" accept="image/*" class="hidden" aria-hidden="true" title="Image upload input" tabindex="-1">
                            <label for="image-upload-input" class="sr-only" id="image-upload-input-label">Upload reference image</label>
                            <button id="analyze-youtube" class="composer-btn" title="Analyze YouTube Tutorial">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M10,15L15.19,12L10,9V15M21.56,7.17C21.69,7.64 21.78,8.27 21.84,9.07C21.91,9.87 21.94,10.56 21.94,11.16L22,12C22,14.19 21.84,15.8 21.56,16.83C21.31,17.73 20.73,18.31 19.83,18.56C19.36,18.69 18.5,18.78 17.18,18.84C15.88,18.91 14.69,18.94 13.59,18.94L12,19C7.81,19 5.2,18.84 4.17,18.56C3.27,18.31 2.69,17.73 2.44,16.83C2.31,16.36 2.22,15.73 2.16,14.93C2.09,14.13 2.06,13.44 2.06,12.84L2,12C2,9.81 2.16,8.2 2.44,7.17C2.69,6.27 3.27,5.69 4.17,5.44C4.64,5.31 5.5,5.22 6.82,5.16C8.12,5.09 9.31,5.06 10.41,5.06L12,5C16.19,5 18.8,5.16 19.83,5.44C20.73,5.69 21.31,6.27 21.56,7.17Z"/>
                                </svg>
                            </button>
                            <button id="send-button" class="composer-btn primary" title="Send (Ctrl+Enter)" disabled>
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M2,21L23,12L2,3V10L17,12L2,14V21Z"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="composer-footer">
                        <span class="char-count">0/1000</span>
                        <span class="shortcut-hint">Ctrl+Enter to send</span>
                        <button id="settings-toggle" class="footer-btn" title="Settings (Ctrl+,)" aria-expanded="false" aria-controls="settings-panel">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11.03L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.22,8.95 2.27,9.22 2.46,9.37L4.57,11.03C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.22,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.68 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </section>

            <!-- Collapsible Tools/Tabs Panel -->
            <section id="settings-panel" class="tabs-panel hidden" role="region" aria-labelledby="settings-panel-heading">
                <div class="tabs-header">
                    <nav class="tab-navigation">
                        <button class="tab-btn active" data-tab="script-library" data-selected="true" aria-controls="script-library-tab">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M8,3A2,2 0 0,0 6,5V9A2,2 0 0,1 4,11H3V13H4A2,2 0 0,1 6,15V19A2,2 0 0,0 8,21H10V19H8V14A2,2 0 0,0 6,12A2,2 0 0,0 8,10V5H10V3M16,3A2,2 0 0,1 18,5V9A2,2 0 0,0 20,11H21V13H20A2,2 0 0,0 18,15V19A2,2 0 0,1 16,21H14V19H16V14A2,2 0 0,1 18,12A2,2 0 0,1 16,10V5H14V3"/>
                            </svg>
                            Script Library
                        </button>
                        <button class="tab-btn" data-tab="settings" aria-controls="settings-tab">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11.03L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.22,8.95 2.27,9.22 2.46,9.37L4.57,11.03C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.22,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.68 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
                            </svg>
                            Settings
                        </button>
                        <button class="tab-btn" data-tab="saved-scripts" aria-controls="saved-scripts-tab">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M17,3H7A2,2 0 0,0 5,5V21L12,18L19,21V5C19,3.89 18.1,3 17,3Z"/>
                            </svg>
                            Saved Scripts
                        </button>

                    </nav>
                    <button id="panel-collapse-btn" class="collapse-btn" title="Collapse Panel">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"/>
                        </svg>
                    </button>
                </div>

                <h2 id="settings-panel-heading" class="sr-only">Tools and Settings Panel</h2>
                <div class="tabs-content" id="settings-panel-content">
                    <!-- Script Library Tab -->
                    <div id="script-library-tab" class="tab-pane active">
                        <div class="script-editor-container">
                            <div class="editor-toolbar">
                                <span class="editor-title">Script Editor</span>
                                <div class="toolbar-actions">
                                    <button id="run-script" class="toolbar-btn primary" title="Run Script">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                            <path d="M8,5.14V19.14L19,12.14L8,5.14Z"/>
                                        </svg>
                                        Run Script
                                    </button>
                                    <button id="apply-expression" class="toolbar-btn" title="Apply Expression">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                            <path d="M9,22A1,1 0 0,1 8,21V18H4A2,2 0 0,1 2,16V4C2,2.89 2.9,2 4,2H20A2,2 0 0,1 22,4V16A2,2 0 0,1 20,18H13.9L10.2,21.71C10,21.9 9.75,22 9.5,22H9M10,16V19.08L13.08,16H20V4H4V16H10Z"/>
                                        </svg>
                                        Apply Expression
                                    </button>
                                    <button class="toolbar-btn" title="Save Script">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                            <path d="M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z"/>
                                        </svg>
                                    </button>
                                    <button class="toolbar-btn" title="Copy Script">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                            <path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            <textarea id="script-editor" class="code-editor" placeholder="// Your ExtendScript code here..."></textarea>
                        </div>
                    </div>

                    <!-- Settings Tab -->
                    <div id="settings-tab" class="tab-pane">
                        <form class="settings-form" aria-describedby="settings-form-desc">
                            <p id="settings-form-desc" class="sr-only">Configure AI provider, model, API key, context and interface options.</p>
                            <fieldset class="setting-group">
                                <legend class="group-label">API Configuration</legend>
                                <div class="api-config-row">
                                    <div class="config-field">
                                        <label for="api-provider">Provider</label>
                                        <select id="api-provider" class="setting-select compact">
                                            <option value="google" selected>Google Gemini (Flash) - Free</option>
                                            <option value="groq">Groq - Free</option>
                                            <option value="cohere">Cohere - Free Tier</option>
                                            <option value="huggingface">Hugging Face - Free</option>
                                            <option value="together">Together AI - Free Tier</option>
                                            <option value="openai">OpenAI - Paid</option>
                                            <option value="claude">Anthropic Claude - Paid</option>
                                            <option value="ollama">Ollama - Local</option>
                                            <option value="local">Local Model</option>
                                        </select>
                                    </div>
                                    <div class="config-field">
                                        <label for="model-select-setting">Model</label>
                                        <select id="model-select-setting" class="setting-select compact">
                                            <option value="gemini-1.5-flash-latest" selected>Gemini 1.5 Flash (Recommended)</option>
                                            <option value="gemini-1.5-pro-latest">Gemini 1.5 Pro</option>
                                            <option value="gemini-pro">Gemini Pro</option>
                                            <option value="llama-3.1-405b-reasoning">Llama 3.1 405B (Groq)</option>
                                            <option value="llama-3.1-70b-versatile">Llama 3.1 70B (Groq)</option>
                                            <option value="llama-3.1-8b-instant">Llama 3.1 8B (Groq)</option>
                                            <option value="mixtral-8x7b-32768">Mixtral 8x7B (Groq)</option>
                                            <option value="gpt-4">GPT-4</option>
                                            <option value="gpt-4-turbo">GPT-4 Turbo</option>
                                            <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                                            <option value="claude-3-opus">Claude 3 Opus</option>
                                            <option value="claude-3-sonnet">Claude 3 Sonnet</option>
                                            <option value="claude-3-haiku">Claude 3 Haiku</option>
                                            <option value="command">Command (Cohere)</option>
                                            <option value="command-light">Command Light (Cohere)</option>
                                            <option value="command-nightly">Command Nightly (Cohere)</option>
                                            <option value="microsoft/DialoGPT-medium">DialoGPT Medium (HF)</option>
                                            <option value="microsoft/DialoGPT-large">DialoGPT Large (HF)</option>
                                            <option value="facebook/blenderbot-400M-distill">BlenderBot (HF)</option>
                                            <option value="togethercomputer/llama-2-7b-chat">Llama 2 7B (Together)</option>
                                            <option value="togethercomputer/llama-2-13b-chat">Llama 2 13B (Together)</option>
                                            <option value="mistralai/Mixtral-8x7B-Instruct-v0.1">Mixtral 8x7B (Together)</option>
                                            <option value="llama2">Llama 2 (Ollama)</option>
                                            <option value="codellama">Code Llama (Ollama)</option>
                                            <option value="mistral">Mistral (Ollama)</option>
                                        </select>
                                    </div>
                                    <div class="config-field api-key-field">
                                        <label for="api-key-setting">API Key</label>
                                        <input type="password" id="api-key-setting" class="setting-input compact" placeholder="Paste your API key" autocomplete="off">
                                    </div>
                                </div>
                            </fieldset>
                            <fieldset class="setting-group">
                                <legend><label for="memory-textarea">Additional Context</label></legend>
                                <textarea id="memory-textarea" class="setting-textarea" placeholder="Tell the AI about your project context..."></textarea>
                            </fieldset>
                            <fieldset class="setting-group">
                                <legend class="group-label">Interface Options</legend>
                                <div class="config-field inline-flex flex-center-y gap-8">
                                    <input type="checkbox" id="mascot-enabled-setting">
                                    <label for="mascot-enabled-setting">Enable Mascot Assistant (animations & thinking indicator)</label>
                                </div>
                            </fieldset>
                            <div class="settings-actions">
                                <button id="save-and-test-settings" class="setting-btn primary" type="button">Save & Test</button>
                                <button id="save-key-file" class="setting-btn" type="button">Export Config</button>
                            </div>
                        </form>
                    </div>

                    <!-- Saved Scripts Tab -->
                    <div id="saved-scripts-tab" class="tab-pane">
                        <div class="empty-state">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor" class="empty-icon">
                                <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                            </svg>
                            <p>No saved scripts yet</p>
                        </div>
                    </div>


                </div>
            </section>
        </main>

        <!-- Status Bar (24-28px) -->
        <footer class="status-bar">
            <div class="status-left">
                <div id="status-indicator" class="status-indicator">
                    <div class="status-dot success"></div>
                    <span>Ready</span>
                </div>
            </div>
            <div id="status-right" class="status-right">
                <span class="message-counter">3 Messages</span>
            </div>
        </footer>

        <!-- Toast Container -->
        <div id="toast-container" class="toast-container"></div>
    </div>

    <!-- Load Scripts -->
    <script src="js/libs/CSInterface.js"></script>
    <script src="js/libs/utility.js"></script>
    <script src="js/modules/simple-toast.js"></script>
    <script src="js/modules/ai-providers.js"></script>
    <script src="js/modules/simple-settings-manager.js"></script>
    <script src="js/modules/simple-youtube-helper.js"></script>
    <script src="js/modules/ai_module.js"></script>
    <script src="js/modules/chat_memory.js"></script>
    <script src="js/modules/tutorial-session.js"></script>
    <script src="js/modules/simple-project-context.js"></script>
            <script src="js/modules/simple-file-upload.js"></script>
    <!-- Reusable Mascot Animator -->
    <script src="Reusable_Mascot_System/js/mascot-animator.js"></script>
    <script src="js/simple-main.js"></script>
    
    <!-- Keyboard shortcuts now handled centrally in js/simple-main.js -->
</body>
</html>
